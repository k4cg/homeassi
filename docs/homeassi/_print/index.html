<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.112.5"><link rel=canonical type=text/html href=https://k4cg.github.io/homeassi/docs/homeassi/><link rel=alternate type=application/rss+xml href=https://k4cg.github.io/homeassi/docs/homeassi/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/homeassi/favicons/favicon.ico><link rel=apple-touch-icon href=/homeassi/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/homeassi/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/homeassi/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/homeassi/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/homeassi/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/homeassi/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/homeassi/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/homeassi/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/homeassi/favicons/android-192x192.png sizes=192x192><title>Homeassi | Goldydocs</title><meta name=description content="Contains Homeassi documentation.
"><meta property="og:title" content="Homeassi"><meta property="og:description" content="Contains Homeassi documentation.
"><meta property="og:type" content="website"><meta property="og:url" content="https://k4cg.github.io/homeassi/docs/homeassi/"><meta itemprop=name content="Homeassi"><meta itemprop=description content="Contains Homeassi documentation.
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Homeassi"><meta name=twitter:description content="Contains Homeassi documentation.
"><link rel=preload href=/homeassi/scss/main.min.e29dc4eae89f5b2a0cef4b0d21d6204859fb9b0002518f66dc2ebd8b3ac25c30.css as=style><link href=/homeassi/scss/main.min.e29dc4eae89f5b2a0cef4b0d21d6204859fb9b0002518f66dc2ebd8b3ac25c30.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/homeassi/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class=navbar-brand__name>Goldydocs</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/homeassi/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/homeassi/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/homeassi/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/homeassi/blog/><span>Blog</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/homeassi/no/>Norsk</a>
<a class=dropdown-item href=/homeassi/fa/>فارسی</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/homeassi/docs/homeassi/>Return to the regular view of this page</a>.</p></div><h1 class=title>Homeassi</h1><div class=lead>Contains Homeassi documentation.</div><ul><li>1: <a href=#pg-5aa75df8426cee5582084793db199426>Homeassi Documentation</a></li><li>2: <a href=#pg-1dbf0c03d54dcfff1cc2c1bb42b61483>K4 internal communicaton diagrams</a></li><li>3: <a href=#pg-d835270d22f48c1aaa42867eb2df79b6>Homeassi Todos</a></li><li>4: <a href=#pg-86d8dd25aadb88358549068cf795d9b9>Deployment mit Gitlab Pages</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-5aa75df8426cee5582084793db199426>1 - Homeassi Documentation</h1><div class=lead>Homeassi documentation.</div><h2 id=grundlegendes>Grundlegendes</h2><ul><li><p><a href=https://www.home-assistant.io/installation/linux>Doku zur Installation</a> (momentan als VM auf einem der <a href=https://proxmox.intern.k4cg.org:8006/>Proxmox Hosts</a> installiert)</p></li><li><p>Web UI unter homeassistant.local:8123 (<strong>TODO</strong> statisches Lease im <a href=https://k4cg.org/index.php/Host:router.intern.k4cg.org>Router</a> erstellen))</p></li><li><p>Username/Passwort vergeben</p></li><li><p>Grundlegene Einstellungen vornehmen</p></li><li><p>Integrationen konfigurieren (<em>Einstellungen - Geraete & Dienste - Integrationen</em>):</p><ul><li><strong>Philips Hue</strong>: mit Knopfdruck an de Hue Bridge verbinden</li><li><strong>OctoPi</strong>: nach Start der Einrichtung im Homeassistant an der <a href=https://octopi.intern.k4cg.org/>OctoPi Web UI</a> anmelden und Anfrage bestaetigen</li><li><strong>Print Server</strong>: geht ohne grossartige Konfiguration</li><li><strong>MQTT</strong>: unter <em>Settings - Devices & Services</em> auf <em>Add Integration</em> klicken<ul><li>Nach MQTT suchen und installieren</li><li>In der Tile der MQTT Integration (unter <em>Settings - Devices & Services</em>) auf <em>Configure</em> klicken und entsprechende Daten eintragen (Zugangsdaten muessen vorger im <a href=https://k4cg.org/index.php/Host:mqtt.intern.k4cg.org>MQTT Server</a> eingerichtet werden)</li><li>Dort gibts auch die Moeglichkeit, mit <em>Listen to a topic</em> Nachrichten fuer ein bestimmtes Topic zu erhalten (nuetzlich fuer Debugging, z.B. <code>sensors/#</code> eintragen)</li></ul></li></ul></li><li><p>Das Default Dashboard, das nach dem Login angezeigt wird, ist schreibgeschuetzt (kann ueber die drei Punkte rechts oben -> <em>Edit Dashboard</em> aber geaendert werden, wenn man unbedingt moechte)</p></li><li><p>Auf dem Default Dashboard werden alle neu erkannten/konfigurierten Dinge angezeigt</p></li><li><p>Unter <em>Settings - Dashboards</em> koennen eigene Dashboards angelegt werden (in unserem Fall z.B. das Dashboard <em>K4CG</em>)</p></li><li><p>Die koennen fuer den schnellen Zugriff auch in der Sidebar auf der linken Seite hinterlegt werden</p></li></ul><p>Das klingt super! Wie fuege ich jetzt einen MQTT Sensor hinzu?</p><p><strong>TODO</strong> besser dokumentieren, wie man einen neuen Sensor hinzufuegt (MQTT Server, Topic, Payload, config.yaml, value_template, Dashboard, InfluxDB und Grafana)</p><ul><li>Custom Definitionen von Sensoren (z.B. <code>sensors/door/default/status</code>) koenen in der config.yaml hinterlegt werden</li><li>Dazu ueber Settings -> Add-ons das <code>File Editor</code> Add-on installieren, starten und in der Sidebar auswaehlen</li><li>Oder das VS Code Add-on installieren, damit koennen die Files mit VS Code direkt im Browser bearbeitet werden (bequemer, weil auto-complete und Syntaxcheck)</li><li>Beispiel für einen Sensor:</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>mqtt</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>sensor</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;Door Status&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>value_template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;{{ value_json.value }}&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>state_topic</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;sensors/door/default/status&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>unique_id</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;sensor_door_status&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><ul><li>Danach ueber Developer Tools -> YAML -> YAML configuration reloading -> Manually configured MQTT entities die MQTT Dinge neu laden</li><li>Eventuell in eigenes Dashboard einbinden</li><li>Profit!</li><li>Docs:<ul><li><a href=https://www.home-assistant.io/integrations/sensor>https://www.home-assistant.io/integrations/sensor</a></li><li><a href=https://opensource.com/article/21/2/home-assistant-custom-sensors>https://opensource.com/article/21/2/home-assistant-custom-sensors</a></li><li><a href=https://www.home-assistant.io/integrations/sensor.mqtt>https://www.home-assistant.io/integrations/sensor.mqtt</a></li><li><a href=https://www.home-assistant.io/docs/configuration/templating/#processing-incoming-data>https://www.home-assistant.io/docs/configuration/templating/#processing-incoming-data</a></li></ul></li><li>Reload ggf. bei anderen Änderungen der Config notwendig, siehe <a href=https://www.home-assistant.io/docs/configuration/>https://www.home-assistant.io/docs/configuration/</a></li></ul><h2 id=sensors>Sensors</h2><h3 id=co2-sensor>CO2 Sensor</h3><ul><li>Projekt: N/A (noch nicht auf <a href=https://k4cg.org>https://k4cg.org</a> dokumentiert)</li><li>Repo: <a href=https://github.com/k4cg/sensors-misc>https://github.com/k4cg/sensors-misc</a></li><li>Herstellerseite: <a href=https://www.tfa-dostmann.de/en/product/co2-monitor-airco2ntrol-mini-31-5006/>https://www.tfa-dostmann.de/en/product/co2-monitor-airco2ntrol-mini-31-5006/</a></li></ul><h4 id=co2>CO2</h4><ul><li>Payload: <code>{ "co2": 824, "_datestr": "2022-09-22T19:45:05.000000", "_timestamp": 1663868705 }</code></li><li>Topic: <code>sensors/co2sensor/default/co2</code></li><li>Retain: <code>false</code></li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.co2 }}"</code></li><li>Unit: <code>ppm</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>co2</td><td>int (?)</td><td>824</td><td>0&mldr;3000 ppm</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h4 id=temperature>Temperature</h4><ul><li>Payload: <code>{ "_datestr": "2022-09-22T19:45:05.000000", "_timestamp": 1663868705, "co2temp": 22.8 }</code></li><li>Topic: <code>sensors/co2sensor/default/temp</code></li><li>Retain: <code>false</code></li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.co2temp }}"</code></li><li>Unit: <code>°C</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>co2temp</td><td>float</td><td>22.8 (1 Nachkommastelle?)</td><td>0&mldr;+50 °C</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h3 id=matomat>Matomat</h3><ul><li>Projekt: <a href=https://k4cg.org/index.php/Projekt:Matomat-Service>https://k4cg.org/index.php/Projekt:Matomat-Service</a></li><li>Repo: <a href=https://github.com/k4cg/matomat-service>https://github.com/k4cg/matomat-service</a></li><li>Payload: <code>{ "EventSource": "matomat", "EventName": "total-items-consumed", "EventTime": 1664471592, "ItemID": 14, "ItemName": "Spezi", "ItemCost": 101, "TotalItemCount": 62 }</code> (schickt noch andere Events, aber nur dieser Event wird im Value Template verwendet)</li><li>Topic: <code>sensors/matomat/status</code></li><li>Retain: <code>false</code> (sollte eigentliche <code>true</code> sein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.TotalItemCount if value_json.ItemName == 'Club Mate' and value_json.EventName == 'total-items-consumed' else states('sensor.matomat_club_mate') }}"</code> (siehe auch <a href=https://community.home-assistant.io/t/template-sensor-based-on-mqtt-data/325418>https://community.home-assistant.io/t/template-sensor-based-on-mqtt-data/325418</a>)</li><li>Unit: N/A</li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>EventSource</td><td>string</td><td>&ldquo;matomat</td><td></td></tr><tr><td>EventName</td><td>string</td><td>&ldquo;total-items-consumed&rdquo;</td><td>&ldquo;item-consumed&rdquo;, &ldquo;total-item-consumed-for-user-changed&rdquo;, &ldquo;total-items-consumed&rdquo;</td></tr><tr><td>EventTime</td><td>int</td><td>1664471592 (unix timestamp)</td><td></td></tr><tr><td>ItemID</td><td>int</td><td>14</td><td></td></tr><tr><td>ItemName</td><td>string</td><td>&ldquo;Spezi&rdquo;</td><td></td></tr><tr><td>ItemCost</td><td>int</td><td>101</td><td></td></tr><tr><td>TotalItemCount</td><td>int</td><td>62</td><td></td></tr></tbody></table><ul><li>Debugging</li></ul><h4 id=items-ausgeben-lassen>Items ausgeben lassen</h4><p>Geht auch direkt am Matomat, wenn man Admin ist.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl -k https://matomat.intern.k4cg.org:8443/v0/auth/login -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -d <span style=color:#4e9a06>&#34;username=&lt;username&gt;&amp;password=&lt;password&gt;&#34;</span> <span style=color:#000;font-weight:700>|</span> jq -r <span style=color:#4e9a06>&#39;.token&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -k https://matomat.intern.k4cg.org:8443/v0/items -H <span style=color:#4e9a06>&#34;Authorization: Bearer </span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[] | { name: .name, id: .id} &#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Club Mate&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bier&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>2</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Apfelschorle&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Mate-Cola&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>4</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Flora&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Spezi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>14</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Diese Werte koennen dann im Template verwendet werden.</p><h4 id=stats-ausgeben-lassen>Stats ausgeben lassen</h4><p>Geht auch direkt am Matomat, wenn man Admin ist.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>curl -k https://matomat.intern.k4cg.org:8443/v0/auth/login -X POST -H <span style=color:#4e9a06>&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -d <span style=color:#4e9a06>&#34;username=&lt;username&gt;&amp;password=&lt;password&gt;&#34;</span> <span style=color:#000;font-weight:700>|</span> jq -r <span style=color:#4e9a06>&#39;.token&#39;</span><span style=color:#204a87;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>curl -k https://matomat.intern.k4cg.org:8443/v0/items/stats -H <span style=color:#4e9a06>&#34;Authorization: Bearer </span><span style=color:#4e9a06>${</span><span style=color:#000>TOKEN</span><span style=color:#4e9a06>}</span><span style=color:#4e9a06>&#34;</span> <span style=color:#000;font-weight:700>|</span> jq <span style=color:#4e9a06>&#39;.[] | { name: .name, id: .id, consumed: .consumed }&#39;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Club Mate&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>494</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Bier&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>880</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Apfelschorle&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>329</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Mate-Cola&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>217</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Flora&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>7</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>51</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;name&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Spezi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;id&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>14</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;consumed&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>62</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h4 id=debugging>Debugging</h4><p>MQTT Config:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mqtt:
</span></span><span style=display:flex><span>    client_id: matomat
</span></span><span style=display:flex><span>    connection_string: tcp://192.168.5.20:1883
</span></span><span style=display:flex><span>    topic: sensors/matomat/status
</span></span><span style=display:flex><span>    username: matomat
</span></span><span style=display:flex><span>    password: &lt;password&gt;
</span></span><span style=display:flex><span>    retain_messages: True
</span></span></code></pre></div><p>Das Passwort findet sich im entweder auf dem <a href=https://k4cg.org/index.php/Host:matomat.intern.k4cg.org>Matomat</a> selbst oder in der Konfig unseres <a href=https://k4cg.org/index.php/Host:mqtt.intern.k4cg.org>MQTT Brokers</a>.</p><p>Zum Debugging kann man sich dann eine Nachricht zusammenbauen und die an das Topic <code>sensors/matomat/status</code> schicken, z.B. so etwas:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;EventSource&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;matomat&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;EventName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;total-items-consumed&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;EventTime&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>1655553901</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;ItemID&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>14</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;ItemName&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Spezi&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;ItemCost&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>101</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>  <span style=color:#204a87;font-weight:700>&#34;TotalItemCount&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>60</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>Das sog. Value Template aktualisiert den Wert des jeweiligen Sensors im Homeassistant nur, wenn der EventName <code>total-items-consumed</code> ist (siehe Homeassi <code>configuration.yaml</code>). Die <code>ItemID</code> bekommt man mit einem <a href=#items-ausgeben-lassen>curl Befehl</a>.</p><p>Download von Debug Informationen der MQTT Integration: <em>Settings - Devices & Services</em>, Klick auf die drei Punkte in der MQTT Tile -> Download diagnostics</p><p>Die Logs unter <em>Settings - System - Logs</em> sind auch manchmal hilfreich.</p><h3 id=door-status>door-status</h3><ul><li>Projekt: <a href=https://k4cg.org/index.php/Projekt:door-status>https://k4cg.org/index.php/Projekt:door-status</a></li><li>Repo: <a href=https://github.com/k4cg/door-status>https://github.com/k4cg/door-status</a></li></ul><h4 id=temperature-1>Temperature</h4><ul><li>Payload: <code>{ "_datestr": "2022-09-22T17:43:59.000000", "value": 21.58, "_timestamp": 1663868639 }</code></li><li>Topic: <code>sensors/door/default/bme280/temperature</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.value }}"</code></li><li>Unit: <code>°C</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>value</td><td>float</td><td>123.45 (2 Nachkommastellen)</td><td>-40.00&mldr;+85.00 °C</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h4 id=humidity>Humidity</h4><ul><li>Payload: <code>{ "_datestr": "2022-09-22T17:43:59.000000", "value": 38.27, "_timestamp": 1663868639 }</code></li><li>Topic: <code>sensors/door/default/bme280/humidity</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.value }}"</code></li><li>Unit: <code>% RH</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>value</td><td>float</td><td>34.56 (2 Nachkommastellen)</td><td>0.00&mldr;100.00 %</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h4 id=pressure>Pressure</h4><ul><li>Payload: <code>{ "_datestr": "2022-09-22T17:43:59.000000", "value": 982.76, "_timestamp": 1663868639 }</code></li><li>Topic: <code>sensors/door/default/bme280/pressure</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.value }}"</code></li><li>Unit: <code>hPa</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>value</td><td>float</td><td>901.56 (2 Nachkommastellen)</td><td>300.00&mldr;1100.00 hPa</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h4 id=status>Status</h4><ul><li>Payload: <code>{ "_datestr": "2022-09-22T17:43:59.000000", "value": "open", "_timestamp": 1663868639 }</code></li><li>Topic: <code>sensors/door/default/status</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt binary_sensor</code></li><li>value_template: <code>"{{ value_json.value }}"</code></li><li>Unit: N/A</li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>value</td><td>string</td><td>&ldquo;open&rdquo;</td><td>&ldquo;open&rdquo;, &ldquo;closed&rdquo;</td></tr><tr><td>_datestr</td><td>date</td><td>YYYY-MM-DDTHH:MM:SS.000000</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h3 id=tennis>Tennis</h3><ul><li>Projekt: <a href=https://k4cg.org/index.php/Host:tennis.intern.k4cg.org>https://k4cg.org/index.php/Host:tennis.intern.k4cg.org</a></li><li>Repo: <a href=https://github.com/Tinkerforge/brick-mqtt-proxy>https://github.com/Tinkerforge/brick-mqtt-proxy</a></li></ul><h4 id=temperature-2>Temperature</h4><ul><li>Doku: <a href=https://www.tinkerforge.com/en/doc/Hardware/Bricklets/Temperature.html#temperature-bricklet>https://www.tinkerforge.com/en/doc/Hardware/Bricklets/Temperature.html#temperature-bricklet</a></li><li>Payload: <code>{ "_timestamp": 1663870803.199035, "temperature": 2443 }</code></li><li>Topic: <code>sensors/tischtennis/bricklet/temperature/tfj/temperature</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.temperature | float / 100 | round(2) }}"</code></li><li>Unit: <code>°C</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>temperature</td><td>int (?)</td><td>1234</td><td>-40°C&mldr;+125°C</td></tr><tr><td>_timestamp</td><td>float</td><td>1663870803.199035 (unix timestamp???)</td><td></td></tr></tbody></table><h4 id=sound-intensity>Sound Intensity</h4><ul><li>Doku: <a href=https://www.tinkerforge.com/en/doc/Hardware/Bricklets/Sound_Intensity.html>https://www.tinkerforge.com/en/doc/Hardware/Bricklets/Sound_Intensity.html</a></li><li>Payload: <code>{ "intensity": 1433, "_timestamp": 1663871103.167636 }</code></li><li>Topic: <code>sensors/tischtennis/bricklet/sound_intensity/voE/intensity</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.intensity }}"</code></li><li>Unit: <code>N/A</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>intensity</td><td>int (?)</td><td>1433</td><td></td></tr><tr><td>_timestamp</td><td>float</td><td>1663871103.167636 (unix timestamp???)</td><td></td></tr></tbody></table><h4 id=uv-light>UV Light</h4><ul><li>Payload: <code>{ "uv_light": 0, "_timestamp": 1663851602.851641 }</code></li><li>Topic: <code>sensors/tischtennis/bricklet/uv_light/xpa/uv_light</code></li><li>Retain: <code>true</code> (HA sagt nein)</li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.uv_light }}"</code></li><li>Unit: <code>µW/cm²</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>uv_light</td><td>int (?)</td><td>1</td><td>0&mldr;1 (?)</td></tr><tr><td>_timestamp</td><td>float</td><td>1663871103.167636 (unix timestamp)</td><td></td></tr></tbody></table><h3 id=wifi>Wifi</h3><ul><li>Projekt: <a href=https://k4cg.org/index.php/Projekt:wifi2mqtt>https://k4cg.org/index.php/Projekt:wifi2mqtt</a></li><li>Repo: <a href=https://github.com/k4cg/wifi2mqtt>https://github.com/k4cg/wifi2mqtt</a></li><li>Payload: <code>{ "online": 7, "_timestamp": "2022-09-22 19:45:33.167346" }</code></li><li>Topic: <code>sensors/wifi/online</code></li><li>Retain: <code>false</code></li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.online }}"</code></li><li>Unit: <code>N/A</code></li><li><input checked disabled type=checkbox> im Grafana eingebaut?</li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>online</td><td>int</td><td>7</td><td></td></tr><tr><td>_timestamp</td><td>date</td><td>YYYY-MM-DD HH:MM:SS.ffffff</td><td></td></tr></tbody></table><h3 id=octopi>OctoPi</h3><ul><li>Projekt: <a href=https://k4cg.org/index.php/Host:octopi.intern.k4cg.org>https://k4cg.org/index.php/Host:octopi.intern.k4cg.org</a></li><li>Repo: <a href=https://github.com/OctoPrint/OctoPrint-MQTT>https://github.com/OctoPrint/OctoPrint-MQTT</a></li><li>Payload: <code>{ "progress": 100, "_timestamp": 1625572970, "location": "local", "path": "usb_cable_holder_v10_0.15mm_PLA_MK3_1h7m.gcode" }</code></li><li>Topic: <code>sensors/octopi/progress/printing</code></li><li>Retain: <code>true</code></li><li>Type: <code>mqtt sensor</code></li><li>value_template: <code>"{{ value_json.progress }}"</code></li><li>Unit: <code>%</code></li><li><input disabled type=checkbox> im Grafana eingebaut? <strong>TODO</strong></li></ul><table><thead><tr><th>Property</th><th>Datentyp</th><th>Format</th><th>Wertebereich</th></tr></thead><tbody><tr><td>progress</td><td>int (?)</td><td>100 (?)</td><td>0&mldr;100 (?)</td></tr><tr><td>location</td><td>string</td><td>&ldquo;local&rdquo;</td><td></td></tr><tr><td>path</td><td>string</td><td>&ldquo;foo.gcode&rdquo;</td><td></td></tr><tr><td>_timestamp</td><td>int</td><td>1663868639 (unix timestamp)</td><td></td></tr></tbody></table><h3 id=sensor-referenzen>Sensor Referenzen</h3><ul><li><a href=https://www.home-assistant.io/integrations/sensor.mqtt>https://www.home-assistant.io/integrations/sensor.mqtt</a></li><li><a href=https://www.home-assistant.io/integrations/sensor/#device-class>https://www.home-assistant.io/integrations/sensor/#device-class</a></li></ul><h2 id=templates>Templates</h2><ul><li><a href=https://www.home-assistant.io/docs/configuration/templating>https://www.home-assistant.io/docs/configuration/templating</a></li></ul><h2 id=dashboards>Dashboards</h2><ul><li><a href=https://www.home-assistant.io/dashboards>https://www.home-assistant.io/dashboards</a></li><li><a href=https://www.home-assistant.io/dashboards/views/>https://www.home-assistant.io/dashboards/views/</a></li><li><a href=https://www.home-assistant.io/dashboards/cards/>https://www.home-assistant.io/dashboards/cards/</a></li></ul><h2 id=automatisierung>Automatisierung</h2><ul><li><a href=https://www.home-assistant.io/docs/automation>https://www.home-assistant.io/docs/automation</a></li><li><a href=https://www.home-assistant.io/docs/automation/action/>https://www.home-assistant.io/docs/automation/action/</a></li><li><a href=https://www.home-assistant.io/docs/scripts/>https://www.home-assistant.io/docs/scripts/</a></li></ul><h2 id=schoene-namen>Schoene Namen</h2><ul><li>Die Namen fuer Entities und Devices lassen sich in der UI und mit Eintraegen in den Config Files anpassen: <a href=https://www.home-assistant.io/docs/configuration/customizing-devices/>https://www.home-assistant.io/docs/configuration/customizing-devices/</a></li></ul><h2 id=wireguard-verbindung-zu-rumpl>Wireguard Verbindung zu rumpl</h2><h3 id=vorbereitungen>Vorbereitungen</h3><ul><li>VPN IP (aus dem Bereich <code>192.168.42.0/24</code>) im Wiki hinterlegen (<a href=https://k4cg.org/index.php/Hosts>https://k4cg.org/index.php/Hosts</a>)</li></ul><h3 id=konfiguration-rumpl>Konfiguration rumpl</h3><ul><li>Verbindung: <code>ssh &lt;user:in>@rumpl.k4cg.org</code></li><li>Wireguard Key generieren (<a href=https://www.wireguard.com/quickstart/>https://www.wireguard.com/quickstart/</a>)</li><li>Wireguard Konfig bearbeiten (<a href=https://k4cg.org/index.php/Projekt:VPN#Wie_kann_auch_meine_Ger.C3.A4t_in_das_VPN.3F>https://k4cg.org/index.php/Projekt:VPN#Wie_kann_auch_meine_Ger.C3.A4t_in_das_VPN.3F</a>)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nix data-lang=nix><span style=display:flex><span><span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>allowedIPs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;192.168.42.5/32&#34;</span> <span style=color:#000;font-weight:700>];</span> <span style=color:#8f5902;font-style:italic># VPN IP homeassi</span>
</span></span><span style=display:flex><span>  <span style=color:#000>publicKey</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;ZdIZn2naS0yDN8OxFXzj7jf0dvNrStUk6bjjytvIkVw=&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic># wg pubkey &lt; privatekey &gt; publickey</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><h3 id=konfiguration-im-home-assistant>Konfiguration im Home Assistant</h3><ul><li>Repo hinzufuegen und <code>wireguard-client</code> Addon installieren (<a href=https://github.com/bigmoby/hassio-repository-addon>https://github.com/bigmoby/hassio-repository-addon</a>)</li><li>Konfig im Homeassi:<ul><li>Start on boot und Watchdog aktivieren (Addon wird neu gestartet, falls es crasht)</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>interface</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>private_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>&lt;private_key&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>address</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>192.168.42.5</span><span style=color:#000>/24</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>dns</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#0000cf;font-weight:700>8.8.8.8</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span>- <span style=color:#0000cf;font-weight:700>8.8.4.4</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>post_up</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>iptables -t nat -A POSTROUTING -o wg0 -j MASQUERADE</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>post_down</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>iptables -t nat -D POSTROUTING -o wg0 -j MASQUERADE</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>peers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span>- <span style=color:#204a87;font-weight:700>public_key</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>fY0GiZHUVGSyuteTwrWTnBpURiGOwtJtP0p4gxBj8UY=</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>endpoint</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>213.95.154.150</span><span style=color:#000;font-weight:700>:</span><span style=color:#0000cf;font-weight:700>51666</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>allowed_ips</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#0000cf;font-weight:700>192.168.42.0</span><span style=color:#000>/24</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>persistent_keep_alive</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;25&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>log_level</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>debug</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic># anpassen, wenn alles funktioniert</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><h3 id=alte-homeassi-konfig>Alte Homeassi Konfig</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@homeassi:~# cat /etc/wireguard/wg-rumpl.conf 
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>Interface<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000>PrivateKey</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#000>Address</span> <span style=color:#ce5c00;font-weight:700>=</span> 192.168.42.5/24
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ce5c00;font-weight:700>[</span>Peer<span style=color:#ce5c00;font-weight:700>]</span>
</span></span><span style=display:flex><span><span style=color:#000>PublicKey</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fY0GiZHUVGSyuteTwrWTnBpURiGOwtJtP0p4gxBj8UY</span><span style=color:#ce5c00;font-weight:700>=</span>
</span></span><span style=display:flex><span><span style=color:#000>AllowedIPs</span> <span style=color:#ce5c00;font-weight:700>=</span> 192.168.42.0/24
</span></span><span style=display:flex><span><span style=color:#000>Endpoint</span> <span style=color:#ce5c00;font-weight:700>=</span> 213.95.154.150:51666
</span></span></code></pre></div><h2 id=influxdb-addon>InfluxDB Addon</h2><h3 id=vorbereitungen-1>Vorbereitungen</h3><h4 id=rumpl>rumpl</h4><ul><li>Admin Zugangsdaten fuer InfluxDB: <code>pass Sites/graphs.k4cg.org</code></li><li>Datenbank und User in der InfluxDB anlegen (<a href=https://docs.influxdata.com/influxdb/v1.8/introduction/get-started/#creating-a-database>https://docs.influxdata.com/influxdb/v1.8/introduction/get-started/#creating-a-database</a> und <a href=https://docs.influxdata.com/influxdb/v1.8/administration/authentication_and_authorization/>https://docs.influxdata.com/influxdb/v1.8/administration/authentication_and_authorization/</a>)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo -iu root
</span></span><span style=display:flex><span>influx --username admin --password <span style=color:#4e9a06>&#39;&#39;</span>
</span></span><span style=display:flex><span>password: <span style=color:#8f5902;font-style:italic># InfluxDB admin Passwort aus pass </span>
</span></span><span style=display:flex><span>&gt; CREATE DATABASE &lt;homeassi_db_name&gt; <span style=color:#8f5902;font-style:italic># home_assistant; alte DB: homeassi</span>
</span></span><span style=display:flex><span>&gt; CREATE USER &lt;homeassi_user&gt; WITH PASSWORD <span style=color:#4e9a06>&#39;&lt;user-password&gt;&#39;</span> <span style=color:#8f5902;font-style:italic># homeassi</span>
</span></span><span style=display:flex><span>&gt; GRANT ALL ON &lt;homeassi_db_name&gt; TO &lt;homeassi_user&gt;
</span></span><span style=display:flex><span>&gt; SHOW GRANTS FOR &lt;homeassi_user&gt;
</span></span><span style=display:flex><span>&gt; GRANT READ ON home_assistant TO grafana <span style=color:#8f5902;font-style:italic># falls die Daten auch in Grafana verfuegbar sein sollen </span>
</span></span><span style=display:flex><span>&gt; SHOW GRANTS FOR grafana
</span></span></code></pre></div><h4 id=homeassi-konfig>Homeassi Konfig</h4><p>Folgendes in der <code>configuration.yaml</code> eintragen:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>influxdb</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>host</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>192.168.42.1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>port</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>8086</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>database</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>home_assistant</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>username</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>homeassi</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>password</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>&lt;password&gt;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># ssl: true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># verify_ssl: true</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>max_retries</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># default_measurement: state</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># exclude:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#   entities:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#      - entity.id1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#      - entity.id2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#   domains:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#      - automation</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic># include:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#   entities:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#      - entity.id3</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#8f5902;font-style:italic>#      - entity.id4</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>tags</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#8f5902;font-style:italic># instance: prod</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>source</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hass</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div><p>Die Konfig muss wahrscheinlich noch ein bisschen angepasst werden. Hier gibts eine Uebersicht, wie man rausfinden kann, was so alles in der Datenbank landet:</p><ul><li><a href=https://docs.influxdata.com/influxdb/v1.8/query_language/explore-data/>https://docs.influxdata.com/influxdb/v1.8/query_language/explore-data/</a></li><li><a href=https://docs.influxdata.com/influxdb/v1.8/query_language/explore-schema/>https://docs.influxdata.com/influxdb/v1.8/query_language/explore-schema/</a></li></ul><h2 id=ssh-addon>SSH Addon</h2><ul><li>Addon installieren</li><li>In den Addon Einstellungen Public Key(s) hinterlegen, Port konfigurieren</li><li>Verbindung mit <code>ssh -i ~/path/to/private_key -p &lt;port> root@&lt;home_assi_ip></code></li><li>HA CLI: <a href=https://www.home-assistant.io/common-tasks/os#home-assistant-via-the-command-line>https://www.home-assistant.io/common-tasks/os#home-assistant-via-the-command-line</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-1dbf0c03d54dcfff1cc2c1bb42b61483>2 - K4 internal communicaton diagrams</h1><div class=lead>Diagrams of the current state and the desired state.</div><h2 id=aktueller-zustand>Aktueller Zustand</h2><figure><img src=/homeassi/docs/homeassi/communication-diagrams/images/k4cg-internal-communication.drawio.svg><figcaption><h4>Diagramm des aktuellen Zustands</h4></figcaption></figure><h2 id=zielzustand>Zielzustand</h2><figure><img src=/homeassi/docs/homeassi/communication-diagrams/images/k4cg-internal-communication-mit-api.drawio.svg><figcaption><h4>Diagramm des Zielzustands</h4></figcaption></figure></div><div class=td-content style=page-break-before:always><h1 id=pg-d835270d22f48c1aaa42867eb2df79b6>3 - Homeassi Todos</h1><div class=lead>Homeassi Todos.</div><h2 id=doku>Doku</h2><ul><li>Evtl. Issues fuer die einzelnen Punkte erstellen</li><li><input checked disabled type=checkbox> Diese Seite als Grundlage fuer die Doku nehmen: <a href=https://docsy.dev/docs/>Docsy User Guide</a> (<a href=https://github.com/google/docsy/tree/master/userguide>Repo</a>)</li><li>Installation und Verwendung Docsy/Hugo dokumentieren</li><li>Publishen mit Github Actions (<a href=https://k4cg.github.io/homeassi/>https://k4cg.github.io/homeassi/</a>)</li><li>Ueberfluessiges Zeug rausnehmen</li><li>About Sektion schreiben (&ldquo;Everything IoT. Homeassistant, MQTT, sensors, status, InfluxDB, Grafana, etc.&rdquo;)</li><li>Blogpost(s) schreiben (was soll das alles, wozu gibt es diese Seite, Ist-Zustand, Plan, Progress Reports)</li><li>Doku vervollstaendigen (Grafana Dashboard erstellen, InfluxDB Aufbau und Zugriff, wie baut man ein neues Getränk ein, wie baut man einen neuen (MQTT) Sensor ein)</li><li>Dashboards dokumentieren</li><li>Diagramm malen<ul><li>Zeug in der K4:<ul><li><input disabled type=checkbox> Sensoren:<ul><li>CO2 (CO2/Temp)</li><li>Matomat</li><li>Door (+Temp/Humidity/Pressure)</li><li>Tennis (Sound/Light/Temp)</li><li>Hosts</li><li>Octopi</li></ul></li><li><input disabled type=checkbox> <a href=https://k4cg.org/index.php/Projekt:wifi2mqtt>wifi2mqtt</a><ul><li>/usr/local/wifi2mqtt auf <code>mqtt.intern.k4cg.org</code></li><li>Wifi Geraete vom <a href=https://k4cg.org/index.php/Host:router.intern.k4cg.org>router</a> => <code>sensors/wifi/online</code></li></ul></li><li><input disabled type=checkbox> <a href=https://k4cg.org/index.php/Host:mqtt.intern.k4cg.org#MQTT2Spacestatus>mqtt2spacestatus</a><ul><li>/usr/local/spacestatus/mqtt2spacestatus.py auf <code>mqtt.intern.k4cg.org</code></li><li>Temp, Matomat, Sound, Light, Humidity, Hosts, Door, Octopi (<code>sensors/#</code>) => <code>/var/www/spacestatus/status.json</code></li></ul></li><li><input disabled type=checkbox> <a href=https://k4cg.org/index.php/Host:mqtt.intern.k4cg.org#Apache>Apache mit status.json</a><ul><li>stellt <code>status.json</code> unter <a href=http://192.168.5.20/status.json>http://192.168.5.20/status.json</a> zur Verfuegung</li><li>von ausserhalb erreichbar unter <a href=http://k4cgrouter.duckdns.org:59468/status.json>http://k4cgrouter.duckdns.org:59468/status.json</a> (Portweiterleitung im <a href=https://k4cg.org/index.php/Host:router.intern.k4cg.org>router</a>)</li><li>Am Ende erreichbar unter <a href=https://status.k4cg.org/status.json>https://status.k4cg.org/status.json</a> (zeigt auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a>, <code>httpd</code> dort macht <code>ProxyPass "/status.json" "http://k4cgrouter.duckdns.org:59468/status.json"</code>)</li></ul></li><li><input disabled type=checkbox> <a href=https://spaceapi.k4cg.org/>Space API</a><ul><li>laeuft auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a></li><li><code>update.py</code> in <code>/var/www/spaceapi.k4cg.org/</code> erstellt aus dem <a href=https://status.k4cg.org/status.json>status</a> die Datei <code>spaceapi.json</code></li><li><code>DirectoryIndex spaceapi.json</code> in der <code>httpd</code> Konfig</li></ul></li><li><input disabled type=checkbox> <a href=http://k4cgrouter.duckdns.org>k4cgrouter</a> mit <a href=https://router.intern.k4cg.org/cgi-bin/luci/admin/network/firewall/forwards>Port Forwardings</a><ul><li><a href=http://k4cgrouter.duckdns.org:59468/status.json>http://k4cgrouter.duckdns.org:59468/status.json</a> => <a href=http://192.168.5.20/status.json>http://192.168.5.20/status.json</a></li><li>alle anderen nicht weiter relevant</li></ul></li><li><input disabled type=checkbox> <a href=https://k4cg.org/index.php/Projekt:SpaceStatus>Projekt SpaceStatus</a><ul><li>Zugriff auf <code>status.json</code><ul><li>IRC Bot (<code>Rezeptionistin</code>): <a href=http://k4cgrouter.duckdns.org:59468/status.json>http://k4cgrouter.duckdns.org:59468/status.json</a></li><li><code>sensor-fetcher</code> (s.u.): <a href=http://k4cgrouter.duckdns.org:59468/status.json>http://k4cgrouter.duckdns.org:59468/status.json</a></li><li>Wiki Status: <a href=https://status.k4cg.org/status.json>https://status.k4cg.org/status.json</a></li><li>Telegram Bot (<code>k4cgbot</code>): <a href=http://k4cgrouter.duckdns.org:59468/status.json>http://k4cgrouter.duckdns.org:59468/status.json</a></li></ul></li></ul></li><li><input checked disabled type=checkbox> Dinge auf mqtt Server, die hier noch nicht aufgelistet sind: sollte alles gewesen sein, siehe <a href=https://k4cg.org/index.php/Host:mqtt.intern.k4cg.org>Eintrag im Wiki</a></li><li><input checked disabled type=checkbox> <a href=https://k4cg.org/index.php/Stats>Projekt Stats</a>: Inhalt im Wiki veraltet, genauso wie <a href=https://k4cg.org/index.php/Projekt:Sensors>Projekt Sensors</a></li></ul></li><li>Zeug auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a><ul><li><code>sensor-fetcher</code><ul><li><code>/usr/local/sensor-fetcher/fetch.py</code> auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a></li><li>schreibt Daten aus <a href=http://k4cgrouter.duckdns.org:59468/status.json>status.json</a> in die InfluxDB <code>sensors</code></li><li>Tennis: Temp, Noise, Light</li><li>Externe Temperatur Wounderground, Open Weather Map, Dark Sky</li><li>Matomat: bier, mate, matecola, apfelschorle</li><li>Hosts</li><li>Door (Status, Humidity)</li></ul></li><li><input disabled type=checkbox> <a href=https://graphs.k4cg.org/>Grafana</a><ul><li>laueft auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a><ul><li><a href="https://graphs.k4cg.org/d/0TS6_uMVk/k4cg-homeassi-influxdb?orgId=1">K4CG Homeassi InfluxDB</a>: <code>home_assistant</code> (wird mit den Daten vom <a href=http://homeassistant.local:8123>neuen Homeassi</a> befuellt)</li><li><a href="https://graphs.k4cg.org/d/000000002/besucher?orgId=1">Besucher</a>: <code>sensors</code> (wird von <a href=https://k4cg.org/index.php/Stats#Besucherzahlen_2>Donnerstats</a> befuellt)</li><li><a href="https://graphs.k4cg.org/d/puOH61mWz/getranke?orgId=1">Getraenke</a>: <code>sensors</code> (wird von <a href=https://k4cg.org/index.php/Projekt:SpaceStatus#Schnittstelle_graphs.k4cg.org>sensor-fetcher</a> befuellt)</li><li><a href="https://graphs.k4cg.org/d/wKojG1kiz/irc-k4cg?orgId=1">IRC users</a>: <code>sensors</code> (Quelle: vielleicht /usr/local/irc2influx)</li><li><a href=https://graphs.k4cg.org/d/kxQQuHRZk/proxmox>Proxmox</a>: <code>proxmox</code> (wird direkt von den Proxmox Hosts proxmox.intern.k4cg.org und beehive.intern.k4cg.org befuellt)</li><li><a href="https://graphs.k4cg.org/d/Xudgohmik/rumpl-k4cg-org?orgId=1&amp;refresh=1m">rumpl</a>: <code>sensors</code> (wird vom <code>telegraf</code> auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a> mit allen moeglichen Systemmetriken befuellt)</li><li><a href="https://graphs.k4cg.org/d/000000001/sensoren?orgId=1">Sensoren</a>: <code>wip</code> (wird vom <code>telegraf</code> auf <code>mqtt.intern.k4cg.org</code> befuellt; <code>["sensors/#"]</code> => InfluxDB <code>wip</code>)</li><li><a href="https://graphs.k4cg.org/d/YKNaVklWz/sensoren-hass-io?orgId=1">Sensoren Hass.io</a>: <code>homeassi</code> (alte DB, obsolet)</li><li><a href="https://graphs.k4cg.org/d/6xEg3A1Vk/wahlcomputer?orgId=1">Wahlcomputer</a>: <code>wahlcomputer</code> (DB fuer den <a href=https://c3wahl.computer/>c3wahlcomputer</a> in der CG)</li><li><a href="https://graphs.k4cg.org/d/000000003/offnungszeiten?orgId=1">Oeffnungszeiten</a>: <code>sensors</code> (Quelle: ???)</li></ul></li></ul></li><li><input disabled type=checkbox> InfluxDB<ul><li>laueft auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a></li><li>Datenbanken:<ul><li><code>sensors</code>: alle moeglichen Daten, default</li><li><code>apache</code>: ???</li><li><code>wip</code>: Quelle: <code>telegraf</code> auf <code>mqtt.intern.k4cg.org</code> (<code>["sensors/#"]</code>); Datenbasis fuer General/Sensoren</li><li>beehive: obsolet???</li><li>homeassi: DB vom alten Home Assi, obsolet</li><li>home_assistant: DB vom neuen Home Assi</li><li>proxmox: Proxmox Metriken von den Hosts <code>beehive</code> und <code>proxmox</code></li><li>wahlcomputer: c3wahlcomputer</li></ul></li></ul></li><li><input disabled type=checkbox> <a href=https://status.k4cg.org/status.json>https://status.k4cg.org/status.json</a><ul><li>zeigt auf <a href=https://k4cg.org/index.php/Host:rumpl.k4cg.org>rumpl</a></li><li><code>httpd</code> dort macht <code>ProxyPass "/status.json" "http://k4cgrouter.duckdns.org:59468/status.json"</code></li></ul></li><li>Dinge auf rumpl, die hier noch nicht aufgelistet sind: <strong>TODO</strong></li></ul></li></ul></li></ul><h2 id=homeassi>Homeassi</h2><ul><li>Automatisches Backup einrichten (<a href=https://addons.mathesonsteplock.ca/docs/addons/remote-backup/basic-config/>https://addons.mathesonsteplock.ca/docs/addons/remote-backup/basic-config/</a>)</li><li>Daten prüfen (Matomat Sensoren, Payload checken)</li><li>Graphs auf neue Daten umbauen</li><li>InfluxDB Config Homeassi checken (include, exclude, evtl. Domains für Sensoren festlegen und das uebrige Zeug excluden, damit nichts unnoetiges gespeichert wird)</li><li>InfluxDB aufräumen (altes Zeug Homeassi)</li><li>API:<ul><li>Queries machen und Daten checken</li><li>Python Skript (nur mit Logik) schreiben</li><li>API mit fastapi bauen</li></ul></li><li>Customizations einbauen?</li><li>Evtl. Device bei den Sensoren eintragen</li><li>Repo aufräumen (<a href=https://github.com/k4cg/k4cg-automation>https://github.com/k4cg/k4cg-automation</a> und dieses Repo)</li><li>Evtl. neue VM provisionieren</li><li>Cleanup Zeug in Playbook einbauen (k4cg-automation)</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-86d8dd25aadb88358549068cf795d9b9>4 - Deployment mit Gitlab Pages</h1><div class=lead>Kurze Beschreibung, wie das Deployent mit Gitlab Pages funktioniert (WIP).</div><h2 id=schritte-fuer-deployment-mit-github-actions-auf-github-pages>Schritte fuer Deployment mit Github Actions auf Github Pages</h2><ul><li>Branch <code>gh-pages</code> anlegen (<a href=https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site>https://docs.github.com/en/pages/getting-started-with-github-pages/configuring-a-publishing-source-for-your-github-pages-site</a>)</li><li>Github Workflow <code>.github/workflows/gh-pages.yml</code> anlegen (<a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>https://gohugo.io/hosting-and-deployment/hosting-on-github/</a>)</li><li>Docsy spezifische Dinge einbauen (<a href=https://github.com/marketplace/actions/hugo-setup#%EF%B8%8F-workflow-for-autoprefixer-and-postcss-cli>https://github.com/marketplace/actions/hugo-setup#%EF%B8%8F-workflow-for-autoprefixer-and-postcss-cli</a>)</li><li><code>npm install</code> ausfuehren, um <code>package-lock.json</code> zu erzeugen</li><li><code>.gitignore</code> anpassen (<code>package-lock.json</code> entfernen)</li><li>baseURL = &ldquo;<a href=https://k4cg.github.io/homeassi%22>https://k4cg.github.io/homeassi"</a> in <code>config.toml</code> eintragen</li></ul><h2 id=fuckup-mit-links-auf-dateien-im-static-ordner>Fuckup mit Links auf Dateien im /static Ordner</h2><p>tl;dr: im Root Verzeichnis gibt es den Ordner <code>static</code>. Auf die darin abgelegten Dateien kann mit <code>/filename.drawio</code> oder <code>/foldername/filename.png</code> verlinkt werden. Das wird dann unter <a href=https://name.tld/>https://name.tld/</a> bereitgestellt (z.B. <a href=https://name.tld/filename.drawio>https://name.tld/filename.drawio</a>). Siehe <a href=https://gohugo.io/content-management/static-files/>Hugo Doku</a>.</p><p>Falls die <code>baseURL</code> in der <code>config.toml</code> aber noch einen &ldquo;Unterordner&rdquo; hat (z.B. <a href=https://k4cg.github.io/homeassi>https://k4cg.github.io/homeassi</a>), funktioniert das nicht mehr. Die relativen Links im Markdown werden in der erzeugten Webseite statt zu <a href=https://k4cg.github.io/homeassi/filename.drawio>https://k4cg.github.io/homeassi/filename.drawio</a> zu <a href=https://k4cg.github.io/filename.drawio>https://k4cg.github.io/filename.drawio</a> umgewandelt und sind kaputt.</p><p>Loesung: Verwendung von <a href=https://gohugo.io/content-management/page-bundles/>Page Bundles</a> statt Dateien im Ordner <code>static</code> abzulegen.</p><h3 id=linksammlung-zum-thema>Linksammlung zum Thema</h3><ul><li><a href=https://github.com/gohugoio/hugo/issues/8078>When using a baseURL with path, links to static resources don&rsquo;t include path</a></li><li><a href=https://discourse.gohugo.io/t/github-actions-deployment-and-baseurl/40570>GitHub Actions Deployment and BaseURL?</a></li><li><a href=https://discourse.gohugo.io/t/publication-on-github-pages-and-baseurl/43631>Publication on GitHub pages and BaseURL</a></li><li><a href="https://discourse.gohugo.io/t/how-to-handle-urls-when-in-a-subfolder/42260/4?u=jmooring">How to handle URLs when in a subfolder?</a></li><li><a href=https://github.com/gohugoio/hugo/issues/10606>Clearly document how to compute URLs that are baseURL aware&mldr;</a></li><li><a href=https://discourse.gohugo.io/t/figure-shortcode-cannot-find-image-in-static-folder-in-site-com-subsite-baseurl/33357>Figure shortcode cannot find image in static folder in site.com/subsite baseURL</a></li><li><a href=https://discourse.gohugo.io/t/docsy-theme-not-rendering-using-github-pages/28109/2>Docsy theme not rendering using GitHub Pages</a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank rel=noopener href=https://example.org/mail aria-label="User mailing list"><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://example.org/twitter aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank rel=noopener href=https://example.org/stack aria-label="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/google/docsy aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://example.org/slack aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Developer mailing list" aria-label="Developer mailing list"><a class=text-white target=_blank rel=noopener href=https://example.org/mail aria-label="Developer mailing list"><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 The Docsy Authors All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small><p class=mt-2><a href=/homeassi/about/>About Docsy</a></p></div></div></div></footer></div><script src=/homeassi/js/main.min.ab62c30bfa612b4bf485ee7c343f3d56b3f1b0290a022a2cfe831abdf53bc5ec.js integrity="sha256-q2LDC/phK0v0he58ND89VrPxsCkKAios/oMavfU7xew=" crossorigin=anonymous></script>
<script src=/homeassi/js/tabpane-persist.js></script></body></html>